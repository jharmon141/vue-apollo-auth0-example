webpackJsonp([1],{0:function(e,t,n){e.exports=n("NHnr")},CPcP:function(e,t){},G3BA:function(e,t){},GJLY:function(e,t){},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("/5sW"),i=(n("SldL"),n("7hDC")),a=n.n(i),r=n("cHfL"),s=n.n(r),c=n("wr2r"),l=n.n(c),u=n("tlQw"),m=n.n(u),p=l()(["\n  query {\n    user {\n      id,\n      name,\n      emailAddress,\n      emailSubscription\n    }\n  }\n"]),d=l()(["\n  query allPosts {\n    allPosts(orderBy: createdAt_DESC) {\n      id\n      imageUrl\n      description\n    }\n  }\n"]),h=m()(p),f=m()(d),g={name:"App",data:function(){return{user:null,lock:new s.a("iBYFD3fZpwKmvINx4Spwm1zjP5M137QH","jharmon141.auth0.com",{auth:{responseType:"token"}}),loading:0}},computed:{authenticated:function(){return!!this.user}},apollo:{user:{query:h,loadingKey:"loading"}},methods:{logout:function(){localStorage.removeItem("auth0IdToken"),localStorage.removeItem("profile"),this.user=null},fetchUser:function(){var e=a()(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$apollo.queries.user.refetch();case 2:return e.next=4,localStorage.getItem("auth0IdToken");case 4:t=e.sent,!this.user&&t&&this.$router.push({name:"createUser"});case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}},v=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("router-view",e._b({on:{logout:e.logout}},"router-view",{loading:e.loading,user:e.user,authenticated:e.authenticated,lock:e.lock,fetchUser:e.fetchUser},!1))],1)},b=[],w=n("XyMi");function k(e){n("G3BA")}var S=!1,_=k,U=null,P=null,x=Object(w["a"])(g,v,b,S,_,U,P),$=x.exports,y=n("u1/p"),j=n("rp1p"),A=n("+dIz"),C=n("uekS"),L=n("69U5"),N=n("/ocq"),O=(n("EuXz"),l()(["\n  mutation ($idToken: String!, $name: String!, $emailAddress: String!, $emailSubscription: Boolean!){\n    createUser(authProvider: {auth0: {idToken: $idToken}}, name: $name, emailAddress: $emailAddress, emailSubscription: $emailSubscription) {\n      id\n    }\n  }\n"])),T=l()(["\n  mutation createPost($description: String!, $imageUrl: String!) {\n    createPost(description: $description, imageUrl: $imageUrl) {\n      id\n      imageUrl\n      description\n    }\n  }\n"]),I=m()(O),E=m()(T),B={name:"CreateUser",props:{loading:Number,user:Object,authenticated:Boolean,fetchUser:Function},data:function(){return{email:"",name:"",emailSubscription:!1}},watch:{user:function(e){e.name&&this.$router.push({name:"home"})}},methods:{createUser:function(){var e=this,t=window.localStorage.getItem("auth0IdToken"),n=this.email,o=this.name,i=this.emailSubscription;this.$apollo.mutate({mutation:I,variables:{idToken:t,name:o,emailAddress:n,emailSubscription:i}}).then(function(){e.fetchUser(),e.$router.push({name:"home"})}).catch(function(e){console.error(e)})}}},q=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.loading>0?[e._v("\n        Loading...\n    ")]:0===e.loading?[n("div",{staticClass:"createUser"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.email,expression:"email"}],attrs:{placeholder:"E-mail Address"},domProps:{value:e.email},on:{input:function(t){t.target.composing||(e.email=t.target.value)}}}),n("input",{directives:[{name:"model",rawName:"v-model",value:e.name,expression:"name"}],attrs:{placeholder:"Name"},domProps:{value:e.name},on:{input:function(t){t.target.composing||(e.name=t.target.value)}}}),n("input",{directives:[{name:"model",rawName:"v-model",value:e.emailSubscription,expression:"emailSubscription"}],attrs:{type:"checkbox",id:"emailSubscription"},domProps:{checked:Array.isArray(e.emailSubscription)?e._i(e.emailSubscription,null)>-1:e.emailSubscription},on:{change:function(t){var n=e.emailSubscription,o=t.target,i=!!o.checked;if(Array.isArray(n)){var a=null,r=e._i(n,a);o.checked?r<0&&(e.emailSubscription=n.concat([a])):r>-1&&(e.emailSubscription=n.slice(0,r).concat(n.slice(r+1)))}else e.emailSubscription=i}}}),n("label",{attrs:{for:"emailSubscription"}},[e._v("Subscribe to email notifications?")]),n("button",{on:{click:function(t){e.createUser()}}},[e._v("Sign Up")])])]:e._e()],2)},z=[];function H(e){n("CPcP")}var R=!1,D=H,F=null,K=null,G=Object(w["a"])(B,q,z,R,D,F,K),J=G.exports,M={name:"CreatePost",props:{authentications:Boolean},data:function(){return{description:"",imageUrl:""}},methods:{create:function(){var e=this,t=this.description,n=this.imageUrl;this.$apollo.mutate({mutation:E,variables:{description:t,imageUrl:n}}).then(function(){e.$router.push({name:"Home"})}).catch(function(e){console.error(e)})}}},Y=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"create"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.description,expression:"description"}],attrs:{placeholder:"Description"},domProps:{value:e.description},on:{input:function(t){t.target.composing||(e.description=t.target.value)}}}),n("input",{directives:[{name:"model",rawName:"v-model",value:e.imageUrl,expression:"imageUrl"}],attrs:{placeholder:"Image url"},domProps:{value:e.imageUrl},on:{input:function(t){t.target.composing||(e.imageUrl=t.target.value)}}}),n("button",{on:{click:e.create}},[e._v("Create Post")])])},Q=[];function X(e){n("GJLY")}var W=!1,Z=X,V=null,ee=null,te=Object(w["a"])(M,Y,Q,W,Z,V,ee),ne=te.exports,oe={name:"Post",props:{post:Object},data:function(){return{image:{"min-width":"50%","max-width":"50%"}}}},ie=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("img",{style:e.image,attrs:{src:e.post.imageUrl}}),n("div",[e._v(e._s(e.post.description))])])},ae=[],re=!1,se=null,ce=null,le=null,ue=Object(w["a"])(oe,ie,ae,re,se,ce,le),me=ue.exports,pe={name:"PostsList",components:{Post:me},data:function(){return{allPosts:{},loading:0}},apollo:{allPosts:{query:f,loadingKey:"loading"}}},de=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"posts-list"}},[e.loading>0?[e._v("\n    Loading...\n  ")]:[n("ul",e._l(e.allPosts,function(e){return n("li",{key:e.id},[n("Post",{staticClass:"post",attrs:{post:e}})],1)}))]],2)},he=[];function fe(e){n("gSq+")}var ge=!1,ve=fe,be=null,we=null,ke=Object(w["a"])(pe,de,he,ge,ve,be,we),Se=ke.exports,_e=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("router-link",{attrs:{to:"/create"}},[e._v("+ New Post")])},Ue=[],Pe=null,xe=!1,$e=null,ye=null,je=null,Ae=Object(w["a"])(Pe,_e,Ue,xe,$e,ye,je),Ce=Ae.exports,Le={name:"LoginAuth0",props:{lock:Object},methods:{showLogin:function(){this.lock.show()}},mounted:function(){var e=this;this.lock.on("authenticated",function(){var t=a()(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,localStorage.setItem("auth0IdToken",n.idToken);case 2:return t.next=4,e.lock.getUserInfo(n.accessToken,function(e,t){e?console.log(e):localStorage.setItem("profile",JSON.stringify(t))});case 4:e.$emit("fetchUser");case 5:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()),this.lock.on("authorization_error",function(e){this.lock.show({flashMessage:{type:"error",text:e.error_description}}),console.log(e)})}},Ne=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"login"}},[n("span",{staticClass:"loginText",on:{click:function(t){e.showLogin()}}},[e._v("Log in with Auth0")])])},Oe=[];function Te(e){n("w+SK")}var Ie=!1,Ee=Te,Be=null,qe=null,ze=Object(w["a"])(Le,Ne,Oe,Ie,Ee,Be,qe),He=ze.exports,Re={name:"Home",props:{authenticated:Boolean,user:Object,lock:Object,fetchUser:Function},components:{LoginAuth0:He,PostsList:Se,NewPostLink:Ce},methods:{login:function(){this.lock.show()}}},De=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"home"},[e.authenticated?n("div",{staticClass:"logout"},[n("div",{staticClass:"logoutButton"},[n("span",{staticClass:"logoutText",on:{click:function(t){e.$emit("logout")}}},[e._v("Logout")])]),n("NewPostLink")],1):n("LoginAuth0",{attrs:{lock:e.lock},on:{fetchUser:e.fetchUser}}),n("div",{staticClass:"feed"},[n("PostsList")],1)],1)},Fe=[];function Ke(e){n("RNFh")}var Ge=!1,Je=Ke,Me=null,Ye=null,Qe=Object(w["a"])(Re,De,Fe,Ge,Je,Me,Ye),Xe=Qe.exports;o["a"].use(N["a"]);var We=new N["a"]({mode:"history",routes:[{path:"/",name:"home",component:Xe},{path:"/signup",name:"createUser",component:J},{path:"/create",name:"createPost",component:ne}]}),Ze=n("NYxO");o["a"].use(Ze["a"]);var Ve=new Ze["a"].Store({state:{},mutations:{},actions:{}});o["a"].config.productionTip=!1;var et=new j["a"]({uri:"https://api.graph.cool/simple/v1/cj0zsz7td3iws01451axem8d3"}),tt=new C["a"](function(e,t){return e.setContext({headers:{authorization:"Bearer ".concat(localStorage.getItem("auth0IdToken"))}}),t(e)}),nt=new y["a"]({link:Object(C["c"])(tt,et),cache:new A["a"],connectToDevTools:!0}),ot=new L["a"]({defaultClient:nt});o["a"].use(L["a"]),new o["a"]({el:"#app",provide:ot.provide(),store:Ve,router:We,render:function(e){return e($)}})},RNFh:function(e,t){},"gSq+":function(e,t){},"w+SK":function(e,t){}},[0]);
//# sourceMappingURL=app.ad6c3bb6.js.map