webpackJsonp([1],{0:function(e,t,n){e.exports=n("NHnr")},CPcP:function(e,t){},G3BA:function(e,t){},GJLY:function(e,t){},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("/5sW"),i=(n("y9m4"),n("cHfL")),a=n.n(i),r=n("wr2r"),s=n.n(r),c=n("tlQw"),l=n.n(c),u=s()(["\n  query {\n    user {\n      id,\n      name,\n      emailAddress,\n      emailSubscription\n    }\n  }\n"]),m=s()(["\n  query allPosts {\n    allPosts(orderBy: createdAt_DESC) {\n      id\n      imageUrl\n      description\n    }\n  }\n"]),d=l()(u),p=l()(m),h={name:"App",data:function(){return{user:null,lock:new a.a("iBYFD3fZpwKmvINx4Spwm1zjP5M137QH","jharmon141.auth0.com",{auth:{responseType:"token"}}),loading:0}},computed:{authenticated:function(){return!!this.user}},apollo:{user:{query:d,loadingKey:"loading"}},methods:{logout:function(){localStorage.removeItem("auth0IdToken"),localStorage.removeItem("profile"),this.user=null},fetchUser:function(){var e=this,t=localStorage.getItem("auth0IdToken"),n=new Promise(function(t){t(e.$apollo.queries.user.refetch())});n.then(function(){!e.user&&t&&e.$router.push({name:"createUser"})})}}},g=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("router-view",e._b({on:{logout:e.logout}},"router-view",{loading:e.loading,user:e.user,authenticated:e.authenticated,lock:e.lock,fetchUser:e.fetchUser},!1))],1)},f=[],v=n("XyMi");function b(e){n("G3BA")}var S=!1,k=b,w=null,_=null,P=Object(v["a"])(h,g,f,S,k,w,_),U=P.exports,$=n("u1/p"),x=n("rp1p"),y=n("+dIz"),j=n("uekS"),A=n("69U5"),C=n("/ocq"),L=(n("EuXz"),s()(["\n  mutation ($idToken: String!, $name: String!, $emailAddress: String!, $emailSubscription: Boolean!){\n    createUser(authProvider: {auth0: {idToken: $idToken}}, name: $name, emailAddress: $emailAddress, emailSubscription: $emailSubscription) {\n      id\n    }\n  }\n"])),N=s()(["\n  mutation createPost($description: String!, $imageUrl: String!) {\n    createPost(description: $description, imageUrl: $imageUrl) {\n      id\n      imageUrl\n      description\n    }\n  }\n"]),O=l()(L),T=l()(N),I={name:"CreateUser",props:{loading:Number,user:Object,authenticated:Boolean,fetchUser:Function},data:function(){return{email:"",name:"",emailSubscription:!1}},methods:{createUser:function(){var e=this,t=window.localStorage.getItem("auth0IdToken"),n=this.email,o=this.name,i=this.emailSubscription;this.$apollo.mutate({mutation:O,variables:{idToken:t,name:o,emailAddress:n,emailSubscription:i}}).then(function(){e.fetchUser(),e.$router.push({name:"home"})}).catch(function(e){console.error(e)})}}},E=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.loading>0?[e._v("\n        Loading...\n    ")]:0===e.loading?[n("div",{staticClass:"createUser"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.email,expression:"email"}],attrs:{placeholder:"E-mail Address"},domProps:{value:e.email},on:{input:function(t){t.target.composing||(e.email=t.target.value)}}}),n("input",{directives:[{name:"model",rawName:"v-model",value:e.name,expression:"name"}],attrs:{placeholder:"Name"},domProps:{value:e.name},on:{input:function(t){t.target.composing||(e.name=t.target.value)}}}),n("input",{directives:[{name:"model",rawName:"v-model",value:e.emailSubscription,expression:"emailSubscription"}],attrs:{type:"checkbox",id:"emailSubscription"},domProps:{checked:Array.isArray(e.emailSubscription)?e._i(e.emailSubscription,null)>-1:e.emailSubscription},on:{change:function(t){var n=e.emailSubscription,o=t.target,i=!!o.checked;if(Array.isArray(n)){var a=null,r=e._i(n,a);o.checked?r<0&&(e.emailSubscription=n.concat([a])):r>-1&&(e.emailSubscription=n.slice(0,r).concat(n.slice(r+1)))}else e.emailSubscription=i}}}),n("label",{attrs:{for:"emailSubscription"}},[e._v("Subscribe to email notifications?")]),n("button",{on:{click:function(t){e.createUser()}}},[e._v("Sign Up")])])]:e._e()],2)},B=[];function q(e){n("CPcP")}var z=!1,H=q,F=null,K=null,D=Object(v["a"])(I,E,B,z,H,F,K),G=D.exports,J={name:"CreatePost",props:{authentications:Boolean},data:function(){return{description:"",imageUrl:""}},methods:{create:function(){var e=this,t=this.description,n=this.imageUrl;this.$apollo.mutate({mutation:T,variables:{description:t,imageUrl:n}}).then(function(){e.$router.push({name:"Home"})}).catch(function(e){console.error(e)})}}},M=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"create"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.description,expression:"description"}],attrs:{placeholder:"Description"},domProps:{value:e.description},on:{input:function(t){t.target.composing||(e.description=t.target.value)}}}),n("input",{directives:[{name:"model",rawName:"v-model",value:e.imageUrl,expression:"imageUrl"}],attrs:{placeholder:"Image url"},domProps:{value:e.imageUrl},on:{input:function(t){t.target.composing||(e.imageUrl=t.target.value)}}}),n("button",{on:{click:e.create}},[e._v("Create Post")])])},Y=[];function Q(e){n("GJLY")}var R=!1,X=Q,W=null,Z=null,V=Object(v["a"])(J,M,Y,R,X,W,Z),ee=V.exports,te={name:"Post",props:{post:Object},data:function(){return{image:{"min-width":"50%","max-width":"50%"}}}},ne=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("img",{style:e.image,attrs:{src:e.post.imageUrl}}),n("div",[e._v(e._s(e.post.description))])])},oe=[],ie=!1,ae=null,re=null,se=null,ce=Object(v["a"])(te,ne,oe,ie,ae,re,se),le=ce.exports,ue={name:"PostsList",components:{Post:le},data:function(){return{allPosts:{},loading:0}},apollo:{allPosts:{query:p,loadingKey:"loading"}}},me=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"posts-list"}},[e.loading>0?[e._v("\n    Loading...\n  ")]:[n("ul",e._l(e.allPosts,function(e){return n("li",{key:e.id},[n("Post",{staticClass:"post",attrs:{post:e}})],1)}))]],2)},de=[];function pe(e){n("gSq+")}var he=!1,ge=pe,fe=null,ve=null,be=Object(v["a"])(ue,me,de,he,ge,fe,ve),Se=be.exports,ke=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("router-link",{attrs:{to:"/create"}},[e._v("+ New Post")])},we=[],_e=null,Pe=!1,Ue=null,$e=null,xe=null,ye=Object(v["a"])(_e,ke,we,Pe,Ue,$e,xe),je=ye.exports,Ae={name:"LoginAuth0",props:{lock:Object},methods:{showLogin:function(){this.lock.show()}},mounted:function(){var e=this;this.lock.on("authenticated",function(t){localStorage.setItem("auth0IdToken",t.idToken),e.lock.getUserInfo(t.accessToken,function(e,t){e?console.log(e):localStorage.setItem("profile",JSON.stringify(t))}),e.$emit("fetchUser")}),this.lock.on("authorization_error",function(e){this.lock.show({flashMessage:{type:"error",text:e.error_description}}),console.log(e)})}},Ce=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"login"}},[n("span",{staticClass:"loginText",on:{click:function(t){e.showLogin()}}},[e._v("Log in with Auth0")])])},Le=[];function Ne(e){n("w+SK")}var Oe=!1,Te=Ne,Ie=null,Ee=null,Be=Object(v["a"])(Ae,Ce,Le,Oe,Te,Ie,Ee),qe=Be.exports,ze={name:"Home",props:{authenticated:Boolean,user:Object,lock:Object,fetchUser:Function},components:{LoginAuth0:qe,PostsList:Se,NewPostLink:je},methods:{login:function(){this.lock.show()}}},He=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"home"},[e.authenticated?n("div",{staticClass:"logout"},[n("div",{staticClass:"logoutButton"},[n("span",{staticClass:"logoutText",on:{click:function(t){e.$emit("logout")}}},[e._v("Logout")])]),n("NewPostLink")],1):n("LoginAuth0",{attrs:{lock:e.lock},on:{fetchUser:e.fetchUser}}),n("div",{staticClass:"feed"},[n("PostsList")],1)],1)},Fe=[];function Ke(e){n("RNFh")}var De=!1,Ge=Ke,Je=null,Me=null,Ye=Object(v["a"])(ze,He,Fe,De,Ge,Je,Me),Qe=Ye.exports;o["a"].use(C["a"]);var Re=new C["a"]({mode:"history",routes:[{path:"/",name:"home",component:Qe},{path:"/signup",name:"createUser",component:G},{path:"/create",name:"createPost",component:ee}]}),Xe=n("NYxO");o["a"].use(Xe["a"]);var We=new Xe["a"].Store({state:{},mutations:{},actions:{}});o["a"].config.productionTip=!1;var Ze=new x["a"]({uri:"https://api.graph.cool/simple/v1/cj0zsz7td3iws01451axem8d3"}),Ve=new j["a"](function(e,t){return e.setContext({headers:{authorization:"Bearer ".concat(localStorage.getItem("auth0IdToken"))}}),t(e)}),et=new $["a"]({link:Object(j["c"])(Ve,Ze),cache:new y["a"],connectToDevTools:!0}),tt=new A["a"]({defaultClient:et});o["a"].use(A["a"]),new o["a"]({el:"#app",provide:tt.provide(),store:We,router:Re,render:function(e){return e(U)}})},RNFh:function(e,t){},"gSq+":function(e,t){},"w+SK":function(e,t){}},[0]);
//# sourceMappingURL=app.3540c9b7.js.map